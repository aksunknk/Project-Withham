# 本番環境移行前テストチェックリスト

## 1. セキュリティテスト

### 1.1 環境変数の確認
- [ ] `SECRET_KEY`が設定されているか
- [ ] `DEBUG = False`が設定されているか
- [ ] `.env`ファイルに機密情報が含まれていないか
- [ ] `.gitignore`に`.env`が含まれているか

### 1.2 セキュリティ設定の確認
- [ ] `ALLOWED_HOSTS`が正しく設定されているか
- [ ] `CSRF_TRUSTED_ORIGINS`が設定されているか
- [ ] パスワードのハッシュ化が正しく行われているか

## 2. データベーステスト

### 2.1 マイグレーション
- [ ] すべてのマイグレーションファイルが存在するか
- [ ] `python manage.py makemigrations`で新しいマイグレーションが作成されないか
- [ ] `python manage.py migrate`が正常に実行できるか

### 2.2 データベースバックアップ
- [ ] データベースのバックアップが取れているか
- [ ] バックアップからの復元が可能か
- [ ] 本番環境用のデータベース接続設定が正しいか

## 3. 静的ファイルとメディアファイルのテスト

### 3.1 静的ファイル
- [ ] `python manage.py collectstatic`が正常に動作するか
- [ ] CSSファイルが正しく読み込まれているか
- [ ] JavaScriptファイルが正しく読み込まれているか
- [ ] 画像ファイルが正しく表示されるか

### 3.2 メディアファイル
- [ ] 画像のアップロードが正常に動作するか
- [ ] アップロードした画像が正しく表示されるか
- [ ] S3の設定が正しく機能しているか
- [ ] 画像の削除が正常に動作するか

## 4. アプリケーション機能テスト

### 4.1 ユーザー認証
- [ ] ユーザー登録が正常に動作するか
- [ ] ログインが正常に動作するか
- [ ] ログアウトが正常に動作するか
- [ ] パスワードリセット機能が動作するか
- [ ] メール認証が正常に動作するか

### 4.2 投稿機能
- [ ] 投稿の作成が正常に動作するか
- [ ] 投稿の編集が正常に動作するか
- [ ] 投稿の削除が正常に動作するか
- [ ] 画像のアップロードが正常に動作するか
- [ ] 投稿の一覧表示が正常に動作するか

### 4.3 コメント機能
- [ ] コメントの投稿が正常に動作するか
- [ ] コメントの編集が正常に動作するか
- [ ] コメントの削除が正常に動作するか

## 5. パフォーマンステスト

### 5.1 ページ読み込み速度
- [ ] トップページの読み込み時間
- [ ] 投稿一覧ページの読み込み時間
- [ ] 画像の読み込み時間

### 5.2 データベース最適化
- [ ] インデックスの設定
- [ ] クエリの最適化
- [ ] N+1問題の確認

## 6. エラーハンドリングテスト

### 6.1 エラーページ
- [ ] 404エラーページの表示
- [ ] 500エラーページの表示
- [ ] 403エラーページの表示

### 6.2 フォームバリデーション
- [ ] 必須項目のチェック
- [ ] 文字数制限のチェック
- [ ] ファイルサイズ制限のチェック

## 7. クロスブラウザテスト

### 7.1 デスクトップブラウザ
- [ ] Google Chrome
- [ ] Mozilla Firefox
- [ ] Safari
- [ ] Microsoft Edge

### 7.2 モバイルブラウザ
- [ ] iOS Safari
- [ ] Android Chrome
- [ ] レスポンシブデザインの確認

## 8. SEO関連テスト

### 8.1 メタ情報
- [ ] タイトルタグの設定
- [ ] メタディスクリプションの設定
- [ ] OGPタグの設定

### 8.2 サイトマップ
- [ ] サイトマップの生成
- [ ] robots.txtの設定
- [ ] 検索エンジンでのインデックス確認

## 9. ログ機能テスト

### 9.1 エラーログ
- [ ] エラーログの記録
- [ ] ログローテーションの設定
- [ ] ログレベルの設定

### 9.2 アクセスログ
- [ ] アクセスログの記録
- [ ] ユーザーアクティビティの記録

## 10. バックアップと復元テスト

### 10.1 データベース
- [ ] バックアップの作成
- [ ] バックアップからの復元
- [ ] バックアップの自動化

### 10.2 メディアファイル
- [ ] S3バケットのバックアップ
- [ ] バックアップからの復元
- [ ] バックアップの自動化

## テスト実行手順

1. 開発環境でテストを実行
```bash
python manage.py test
```

2. 静的ファイルの収集
```bash
python manage.py collectstatic --noinput
```

3. データベースのバックアップ
```bash
python manage.py dumpdata > backup.json
```

4. 本番環境でのテスト
- Renderのデプロイログを確認
- エラーログの確認
- 各機能の動作確認

## 注意事項

- テストは開発環境で十分に行ってから本番環境に移行すること
- 本番環境のデータは必ずバックアップを取ること
- 機密情報は環境変数で管理すること
- エラーが発生した場合は、ログを確認して原因を特定すること 